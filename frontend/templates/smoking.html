{% extends "base.html" %}

{% block title %}–ö—É—Ä–µ–Ω–∏–µ{% endblock %}

{% block body %}
<div class="smoking-container">
    <h2 class="smoking-title">–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫—É—Ä–µ–Ω–∏—è</h2>
    <p class="smoking-text">–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –∑–∞–ø–∏—Å—ã–≤–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–≥–∞—Ä–µ—Ç, —á—Ç–æ–±—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å.</p>

    {% if error %}
        <div class="alert alert-danger">{{ error }}</div>
    {% endif %}

    <!-- –§–æ—Ä–º–∞ –¥–ª—è –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö -->
    <form id="smoking-form" class="smoking-form" method="post">
        <div class="input-group mb-3 justify-content-center">
            <label for="puffs" class="form-label visually-hidden">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–≥–∞—Ä–µ—Ç:</label>
            <input type="number" id="puffs" name="puffs" class="form-control w-50 text-center" min="0" required>
            <button type="submit" id="submit-button" class="btn btn-primary ms-2">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </form>

    <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å -->
    <div class="progress-container">
        <div class="progress-label">–ü—Ä–æ–≥—Ä–µ—Å—Å: <span id="progressText">{{ progress }}%</span></div>
        <div class="progress">
            <div id="progressFill" class="progress-bar" role="progressbar" style="width: {{ progress }}%;" aria-valuenow="{{ progress }}" aria-valuemin="0" aria-valuemax="100">{{ progress }}%</div>
        </div>
    </div>

    <!-- –¢–∞–±–ª–∏—Ü–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <h3 class="mt-4 mb-3 text-center">üìä –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
    <div class="table-responsive">
        <table class="table table-hover table-borderless align-middle text-center shadow-sm rounded">
            <thead class="table-light">
                <tr>
                    <th class="fs-5">–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å</th>
                    <th class="fs-5">–ó–Ω–∞—á–µ–Ω–∏–µ</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="fw-semibold">–°–∏–≥–∞—Ä–µ—Ç —Å–µ–≥–æ–¥–Ω—è</td>
                    <td class="text-primary fs-5">{{ smoked_today }}</td>
                </tr>
                <tr>
                    <td class="fw-semibold">–°–∏–≥–∞—Ä–µ—Ç –∑–∞ –º–µ—Å—è—Ü</td>
                    <td class="text-success fs-5">{{ monthly_cigarettes }}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const input = document.getElementById("puffs");
        const button = document.getElementById("submit-button");

        input.addEventListener("input", () => {
            const value = parseInt(input.value);

            if (isNaN(value) || value < 0) {
                button.style.backgroundColor = "";
                return;
            }

            if (value <= 5) {
                button.style.backgroundColor = "#28a745"; // –∑–µ–ª—ë–Ω—ã–π
            } else if (value <= 10) {
                button.style.backgroundColor = "#ffc107"; // –∂—ë–ª—Ç—ã–π
            } else {
                button.style.backgroundColor = "#dc3545"; // –∫—Ä–∞—Å–Ω—ã–π
            }
        });
    });
</script>
{% endblock %}
